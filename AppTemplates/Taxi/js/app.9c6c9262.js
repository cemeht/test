(function(t){function e(e){for(var n,o,i=e[0],c=e[1],u=e[2],m=0,h=[];m<i.length;m++)o=i[m],s[o]&&h.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(h.length)h.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,i=1;i<a.length;i++){var c=a[i];0!==s[c]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},s={app:0},r=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"0408":function(t,e,a){},"04ac":function(t,e,a){},"2c72":function(t,e,a){"use strict";var n=a("0408"),s=a.n(n);s.a},4678:function(t,e,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=r(t);return a(e)}function r(t){var e=n[t];if(!(e+1)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return e}s.keys=function(){return Object.keys(n)},s.resolve=r,t.exports=s,s.id="4678"},"568b":function(t,e,a){},"5c0b":function(t,e,a){"use strict";var n=a("5e27"),s=a.n(n);s.a},"5e27":function(t,e,a){},7829:function(t,e,a){"use strict";var n=a("568b"),s=a.n(n);s.a},9558:function(t,e,a){"use strict";var n=a("f44f"),s=a.n(n);s.a},cd49:function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("link",{attrs:{href:"https://fonts.googleapis.com/css?family=Roboto+Condensed",rel:"stylesheet"}}),a("div",{staticClass:"panels"},[a("div",{staticClass:"panels__left"},[t._m(0),a("section",{staticClass:"panels__carlist"},[a("Cars",{attrs:{treeGroups:t.treeGroups,treeCars:t.treeCars,commandStatusCars:t.commandStatusCars,commandStatusOk:t.commandStatusOk}})],1),a("section",{staticClass:"panels__info"},[null!=t.currentCar?[a("Period",{attrs:{currentTrip:t.CurrentTrip}})]:[a("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n                        Выберите транспортное средство\n                    ")])]],2),a("section",{staticClass:"panels__journal"},[null!=t.currentCar?[a("CarState",{attrs:{currentCar:t.currentCar,commandStatusCar:t.commandStatusCars[t.currentCar.ID],commandStatusOk:t.commandStatusOk,commandName:t.commandName,commandOut:t.commandOut}})]:t._e(),a("Journal",{attrs:{currentCar:t.currentCar,cars:t.cars,commandName:t.commandName,commandOut:t.commandOut}})],2),a("footer",{staticClass:"footer"},[t._v("\n                © AutoGRAPH\n            ")])]),t._m(1)])])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"header"},[a("div",{staticClass:"header__logo"},[t._v("\n                    Taxi\n                ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"panels__right"},[a("div",{staticClass:"map",attrs:{id:"map"}})])}],o=(a("456d"),a("55dd"),a("ac6a"),a("d225")),i=a("b0b4"),c=a("308d"),u=a("6bb5"),l=a("4e2b"),m=a("9ab4"),h=a("60a3"),d=a("e11e"),f=a.n(d),p=a("c1df"),v=a.n(p);a("6b54");function I(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e?v.a.utc(t).local():v()(t);return{D:a.format("DD.MM.YYYY"),T:a.format("HH:mm"),V:a.format("YYYYMMDDHHmm")}}function D(t){var e=v()(t,"HH:mm:ss");return 0==e.hours()&&e.minutes()<5?"":(e.hours()>0?e.hours()+" ч ":"")+e.minutes()+" мин"}function b(t,e){var a=(+new Date-v()(t._LastData).toDate())/1e3;return f.a.divIcon({html:['<div class="car-marker__title title">',e.Name,'</div><img src="',vt.Urls.ImageCar,"/",e.ImageColored,'" class="car-marker__image" />'].join(""),className:"car-marker "+(a<36e3?"":"old-data")})}function j(t,e,a){var n=[];return e&&n.push(e.Name),n.push("<div><strong>"+a.Name+" ("+t.Serial.toString()+")</strong></div>"),n.push('<table class="table mb-0">'),n.push("<tbody>"),n.push('<tr><td>Скорость:</td><td class="text-right">'+(a.Speed<.5?"Стоит":a.Speed.toFixed(2)+" км/ч")+"</td></tr>"),n.push('<tr><td>Данные:</td><td class="text-right">'+v()(a._LastData).fromNow()+"</td></tr>"),n.push("</tbody>"),n.push("</table>"),n.join("")}var O=function(){function t(e){Object(o["a"])(this,t),this.SD=new Date,this.S="",this.ED=new Date,this.E="",this.VRN="",this.Items=[],this.geofences={},this.layerTrip=f.a.layerGroup([],{}),this.connector=e}return Object(i["a"])(t,[{key:"Build",value:function(t,e,a){var n=this;this.Car=t,this.connector.GetTrips([t.ID],e,a,-1,["TotalDistance","MoveDuration","ParkDuration"]).then(function(s){var r=t.Properties.filter(function(t){return"VehicleRegNumber"==t.Name});if(n.Items=[],n.SD=e,n.ED=a,0==s.length||0==s[0].Trips.length)n.VRN=r.length?r[0].Value:"",n.S=I(e),n.E=I(a);else{var o=s[0].Trips[0];n.S=I(o.SD),n.E=I(o.ED);var i=t.Properties.filter(function(t){return"VehicleRegNumber"==t.Name});n.VRN=i.length?i[0].Value:"",o.Stages.filter(function(t){return 0==t.Name.indexOf("GeoFence")}).forEach(function(t){var e=t.Params.indexOf("TotalDistance"),a=t.Params.indexOf("MoveDuration"),s=t.Params.indexOf("ParkDuration");n.Items=t.Items.map(function(t){if(null==t.StatusIDs){var r=D(t.Values[a]),o=D(t.Values[s]);return r||o?{Type:0,MoveDuration:r,ParkDuration:o}:{Type:-1}}return{Type:1,S:I(t.SD,!0),E:I(t.ED,!0),GF:n.geofences[t.StatusID],PStart:f.a.latLng(t.StartPoint.Lat,t.StartPoint.Lng),PEnd:f.a.latLng(t.EndPoint.Lat,t.EndPoint.Lng),Distance:t.Values[e]}})})}0==n.Items.length?n.layerTrip.clearLayers():n.connector.GetTrack([t.ID],e,a).then(function(t){n.layerTrip.clearLayers(),t.length&&t[0].Item&&t[0].Item.length&&n.trackBuild(t[0].Item[0])})})}},{key:"Shift",value:function(t){this.SD&&this.Car&&this.Build(this.Car,v()(this.SD).add(t,"days").toDate(),v()(this.ED).add(t,"days").toDate())}},{key:"trackBuild",value:function(t){for(var e=[],a=f.a.latLngBounds([]),n=0;n<t.Lat.length;n++){var s=f.a.latLng(t.Lat[n],t.Lng[n]);e.push(s),a.extend(s)}f.a.polyline(e,{color:"green",weight:8,opacity:.5}).addTo(this.layerTrip),this.map&&this.map.fitBounds(a)}},{key:"ClearTrip",value:function(){this.layerTrip.clearLayers(),this.Items=[]}}]),t}(),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cars"},[a("CarsItem",{attrs:{parentID:null,treeGroups:t.treeGroups,treeCars:t.treeCars,activeItem:t.activeItem,commandStatusCars:t.commandStatusCars,commandStatusOk:t.commandStatusOk}})],1)},_=[],C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cars__level"},t._l(t.treeGroups[t.parentID],function(e){return a("div",{class:{cars__item:!0,"cars__item--active":e.ID==t.activeItem}},[a("div",{staticClass:"cars__name"},[a("a",{staticClass:"cars__name-link",attrs:{href:"#no-click"},on:{click:function(a){return t.clickGroupItem(e.ID,a)}}},[t._v(t._s(e.Name))])]),a("div",{staticClass:"cars__list"},[t.treeGroups[e.ID]?[a("CarsItem",{attrs:{parentID:e.ID,treeGroups:t.treeGroups,treeCars:t.treeCars,activeItem:t.activeItem,commandStatusCars:t.commandStatusCars,commandStatusOk:t.commandStatusOk}})]:t._e(),t.treeCars[e.ID]?t._l(t.treeCars[e.ID],function(e){return a("div",{class:{cars__item:!0,"cars__item--active":e.ID==t.activeItem}},[a("div",{staticClass:"cars__name",on:{click:function(a){return t.clickCarItem(e.ID)}}},[a("span",{staticClass:"cars__name-link"},[t._v(t._s(e.Name))]),t._l(e.Properties,function(e){return["VehicleRegNumber"==e.Name?a("span",{staticClass:"cars__vrn"},[t._v("\n                                "+t._s(e.Value)+"\n                            ")]):t._e()]}),a("span",{class:{cars__state:!0,"cars__state--unknown":0===t.state(t.commandStatusCars[e.ID]),"cars__state--on":1===t.state(t.commandStatusCars[e.ID]),"cars__state--off":-1===t.state(t.commandStatusCars[e.ID])}})],2)])}):t._e()],2)])}),0)},G=[],E=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(i["a"])(e,[{key:"clickGroupItem",value:function(t,e){e.preventDefault(),pt.$emit("SelectGroupItem",t)}},{key:"clickCarItem",value:function(t){pt.$emit("SelectCarItem",t)}},{key:"state",value:function(t){return void 0===t?0:t.Status===this.commandStatusOk&&"1"==t.Arguments[1]?1:t.Status===this.commandStatusOk&&"0"==t.Arguments[1]?-1:0}}]),e}(h["c"]);m["a"]([Object(h["b"])()],E.prototype,"treeGroups",void 0),m["a"]([Object(h["b"])()],E.prototype,"treeCars",void 0),m["a"]([Object(h["b"])()],E.prototype,"commandStatusCars",void 0),m["a"]([Object(h["b"])()],E.prototype,"commandStatusOk",void 0),m["a"]([Object(h["b"])()],E.prototype,"parentID",void 0),m["a"]([Object(h["b"])()],E.prototype,"activeItem",void 0),E=m["a"]([h["a"]],E);var y=E,g=y,k=a("2877"),N=Object(k["a"])(g,C,G,!1,null,null,null),T=N.exports,M=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.activeItem="",t}return Object(l["a"])(e,t),Object(i["a"])(e,[{key:"created",value:function(){var t=this;pt.$on("SelectGroupItem",function(e){return t.activeItem=e}),pt.$on("SelectCarItem",function(e){return t.activeItem=e})}}]),e}(h["c"]);m["a"]([Object(h["b"])()],M.prototype,"treeGroups",void 0),m["a"]([Object(h["b"])()],M.prototype,"treeCars",void 0),m["a"]([Object(h["b"])()],M.prototype,"commandStatusCars",void 0),m["a"]([Object(h["b"])()],M.prototype,"commandStatusOk",void 0),M=m["a"]([Object(h["a"])({components:{CarsItem:T}})],M);var P=M,A=P,R=(a("7829"),Object(k["a"])(A,S,_,!1,null,null,null)),L=R.exports,F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"period"},[a("button",{staticClass:"period__down",on:{click:function(e){return t.currentTrip.Shift(-1)}}},[t._v("<")]),a("span",{staticClass:"period__date"},[t._v(t._s(t.currentTrip.S.D)+" "+t._s(t.currentTrip.S.T))]),a("span",[t._v("—")]),a("span",{staticClass:"period__date"},[t._v(t._s(t.currentTrip.E.D)+" "+t._s(t.currentTrip.E.T))]),a("button",{staticClass:"period__up",on:{click:function(e){return t.currentTrip.Shift(1)}}},[t._v(">")])])},w=[],x=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),e}(h["c"]);m["a"]([Object(h["b"])()],x.prototype,"currentTrip",void 0),x=m["a"]([h["a"]],x);var $=x,z=$,U=(a("9558"),Object(k["a"])(z,F,w,!1,null,null,null)),V=U.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"car-state"},[t._v("\n    Состояние:"),0==t.state?a("span",{staticClass:"car-state__value"},[t._v("неизвестно")]):t._e(),1==t.state?a("span",{staticClass:"car-state__value"},[t._v("включено")]):t._e(),-1==t.state?a("span",{staticClass:"car-state__value"},[t._v("выключено")]):t._e(),0==t.state||1==t.state?a("button",{staticClass:"car-state__control car-state__control--off",on:{click:function(e){return t.changeState("0")}}},[t._v("выключить")]):t._e(),0==t.state||-1==t.state?a("button",{staticClass:"car-state__control car-state__control--on",on:{click:function(e){return t.changeState("1")}}},[t._v("включить")]):t._e()])},W=[],H=function(t){function e(){return Object(o["a"])(this,e),Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments))}return Object(l["a"])(e,t),Object(i["a"])(e,[{key:"changeState",value:function(t){It.SendCommand([this.currentCar.ID],this.commandName,[this.commandOut,t]).then(function(e){pt.$emit("ChangeCarState",t)})}},{key:"state",get:function(){return void 0===this.commandStatusCar?0:this.commandStatusCar.Status===this.commandStatusOk&&"1"==this.commandStatusCar.Arguments[1]?1:this.commandStatusCar.Status===this.commandStatusOk&&"0"==this.commandStatusCar.Arguments[1]?-1:0}}]),e}(h["c"]);m["a"]([Object(h["b"])()],H.prototype,"currentCar",void 0),m["a"]([Object(h["b"])()],H.prototype,"commandStatusCar",void 0),m["a"]([Object(h["b"])()],H.prototype,"commandStatusOk",void 0),m["a"]([Object(h["b"])()],H.prototype,"commandName",void 0),m["a"]([Object(h["b"])()],H.prototype,"commandOut",void 0),H=m["a"]([h["a"]],H);var Y=H,q=Y,J=(a("2c72"),Object(k["a"])(q,B,W,!1,null,null,null)),K=J.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"journal"},[a("div",{staticClass:"journal__wrap"},[t.log.length>0?[a("table",{staticClass:"journal__table table"},[a("thead",[a("tr",[null==t.currentCar?a("th",[t._v("ТС")]):t._e(),a("th",[t._v("Команда  ")]),a("th",[t._v("Дата")]),a("th",[t._v("Ответ")]),a("th",[a("div",{staticClass:"journal__control"},[a("span",{staticClass:"journal__control-caption"},[t._v("Статус")]),a("button",{staticClass:"journal__refresh",on:{click:function(e){return t.refresh()}}},[a("i",{staticClass:"icon-reload"})])])])])]),a("tbody",t._l(t.log,function(e){return a("tr",[null==t.currentCar?a("td",[t._v(t._s(t.cars[e.IDCAR].Name)),a("br"),a("small",[t._v("№"+t._s(e.Serial))])]):t._e(),"1"==e.Arguments[1]?a("td",[t._v("on")]):a("td",[t._v("off")]),a("td",[t._v(t._s(e.DT))]),a("td",[t._v(t._s(e.ResponseDT))]),0==e.Status?a("td",[t._v("InProgress")]):t._e(),1==e.Status?a("td",[t._v("OK")]):t._e(),2==e.Status?a("td",[t._v("Failed")]):t._e(),3==e.Status?a("td",[t._v("Timeout")]):t._e()])}),0)])]:[a("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n                Нет записей\n            ")])]],2)])},Q=[],Z=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.historyPeriodDays=7,t.log=[],t}return Object(l["a"])(e,t),Object(i["a"])(e,[{key:"mounted",value:function(){var t=this;pt.$on("RefreshCommandsLog",function(){var e=v()().startOf("day").add(-t.historyPeriodDays,"day").toDate(),a=v()().toDate();t.log=[],It.GetCommandLog(e,a).then(function(e){var a=e.filter(function(e){return e.Name==t.commandName&&e.Arguments.length>0&&e.Arguments[0]==t.commandOut});if(a.reverse(),pt.$emit("ResultCommandsLog",a),null==t.currentCar?t.log=a:a.forEach(function(e){null!=t.currentCar&&t.currentCar.ID==e.IDCAR&&t.log.push(e)}),t.log.forEach(function(t){var e=I(t.DT,!0);if(t.DT=e.D+" "+e.T,t.ResponseDT){var a=I(t.ResponseDT,!0);t.ResponseDT=a.D+" "+a.T}}),t.log.length>0){var n=document.querySelector(".footer"),s=document.querySelector(".journal__wrap"),r=s.getBoundingClientRect();s.style.height=window.innerHeight-r.top-n.clientHeight+"px"}})}),this.$watch("currentCar",function(){return t.refresh()})}},{key:"refresh",value:function(){pt.$emit("RefreshCommandsLog")}}]),e}(h["c"]);m["a"]([Object(h["b"])()],Z.prototype,"currentCar",void 0),m["a"]([Object(h["b"])()],Z.prototype,"cars",void 0),m["a"]([Object(h["b"])()],Z.prototype,"commandName",void 0),m["a"]([Object(h["b"])()],Z.prototype,"commandOut",void 0),Z=m["a"]([h["a"]],Z);var tt=Z,et=tt,at=(a("dfd0"),Object(k["a"])(et,X,Q,!1,null,null,null)),nt=at.exports,st=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(u["a"])(e).call(this)),t.commandName="MOUT",t.commandOut="1",t.commandStatusOk=1,t.layerCars=f.a.layerGroup([],{}),t.carGroups={},t.cars={},t.treeGroups={},t.treeCars={},t.commandStatusCars={},t.currentCar=null,t.CurrentTrip=new O(It),t}return Object(l["a"])(e,t),Object(i["a"])(e,[{key:"created",value:function(){var t=this;pt.$on("SelectGroupItem",function(e){t.refreshPositions(e),t.currentCar=null}),pt.$on("SelectCarItem",function(e){var a=v()().startOf("day").add(-1,"day").toDate(),n=v()(a).add(2,"day").toDate();t.currentCar=t.cars[e],t.CurrentTrip.Build(t.currentCar,a,n)}),pt.$on("ChangeCarState",function(){pt.$emit("RefreshCommandsLog")}),pt.$on("ResultCommandsLog",function(e){t.commandStatusCars={},e.forEach(function(e){e.Name==t.commandName&&e.Arguments.length>0&&e.Arguments[0]==t.commandOut&&!t.commandStatusCars[e.IDCAR]&&(t.commandStatusCars[e.IDCAR]=e)})})}},{key:"mounted",value:function(){var t=this;this.CurrentTrip.map=this.map=f.a.map("map",{preferCanvas:!0,zoomControl:!1}),f.a.control.zoom({position:"topright"}).addTo(this.map),this.map.addLayer(f.a.tileLayer("//{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",{updateWhenIdle:!0,detectRetina:!0})).setView([55.5,61.2],13).addLayer(this.layerCars).addLayer(this.CurrentTrip.layerTrip),It.EnumDevices().then(function(e){for(var a in t.treeGroups={},e.Groups.forEach(function(e){t.treeGroups[e.ParentID]||(t.treeGroups[e.ParentID]=[]),t.treeGroups[e.ParentID].push(e)}),t.treeCars={},e.Items.forEach(function(e){t.treeCars[e.ParentID]||(t.treeCars[e.ParentID]=[]),t.treeCars[e.ParentID].push(e)}),t.treeCars)t.treeCars[a].sort(function(t,e){return t.Name>e.Name?1:-1});e.Items.forEach(function(e){return t.cars[e.ID]=e}),t.refreshPositions(null),pt.$emit("RefreshCommandsLog")})}},{key:"refreshPositions",value:function(t){var e=this;It.GetOnlineInfo(null==t?null:[t]).then(function(t){var a=f.a.latLngBounds([]);e.layerCars.clearLayers(),Object.keys(t).forEach(function(n){var s=t[n];null!=s&&null!=s._LastCoords&&e.refreshPositionItem(s,a)}),e.map&&a.isValid()&&e.map.fitBounds(a)})}},{key:"refreshPositionItem",value:function(t,e){var a=f.a.latLng(t.LastPosition.Lat,t.LastPosition.Lng),n=this.cars[t.ID];n&&(f.a.marker(a,{icon:b(t,n),carID:t.ID}).bindTooltip(j(n,this.carGroups[n.ParentID],t)).on("click",function(t){return pt.$emit("SelectCarItem",t.target.options.carID)}).addTo(this.layerCars),e.extend(a))}}]),e}(h["c"]);st=m["a"]([Object(h["a"])({components:{Cars:L,Period:V,CarState:K,Journal:nt}})],st);var rt,ot,it,ct=st,ut=ct,lt=(a("5c0b"),Object(k["a"])(ut,s,r,!1,null,null,null)),mt=lt.exports,ht=(a("4917"),a("bc3a")),dt=a.n(ht),ft=function(){function t(e,a,n,s,r){Object(o["a"])(this,t),this.url="",this.token="",this.schemaID="",this.serviceName="",this.FMT_DT="YYYYMMDD-HHmm",this.url=e+"/",this.token=a,this.schemaID=s||"",this.serviceName=n||"",this.changeStateCallback=r||function(t){}}return Object(i["a"])(t,[{key:"post",value:function(t,e,a){var n=this;this.changeStateCallback(!0);var s=new FormData;for(var r in e)s.append(r,e[r]);return dt.a.post(this.url+t,s).then(function(t){return a&&(t.data=a(t.data)),n.changeStateCallback(!1),t.data})}},{key:"convert",value:function(t){var e=[];for(var a in t)t[a]&&e.push(t[a]);return e}},{key:"colorFromARGB",value:function(t){t>>>=0;var e=255&t,a=(65280&t)>>>8,n=(16711680&t)>>>16;return"rgba("+[n,a,e].join(",")+")"}},{key:"EnumSchemas",value:function(){return this.post("EnumSchemas",{session:this.token})}},{key:"EnumDevices",value:function(){return this.post("EnumDevices",{session:this.token,schemaID:this.schemaID})}},{key:"EnumGeofences",value:function(){return this.post("EnumGeoFences",{session:this.token,schemaID:this.schemaID})}},{key:"EnumDrivers",value:function(){return this.post("EnumDrivers",{session:this.token,schemaID:this.schemaID})}},{key:"EnumImplements",value:function(){return this.post("EnumImplements",{session:this.token,schemaID:this.schemaID})}},{key:"EnumParameters",value:function(t){var e=this;return this.post("EnumParameters",{session:this.token,schemaID:this.schemaID,IDs:null==t?"":t.join(",")},function(t){return e.convert(t)})}},{key:"GetGeofences",value:function(t){var e=this;return this.post("GetGeoFences",{session:this.token,schemaID:this.schemaID,IDs:null==t?"":t.join(",")},function(t){var a=[];for(var n in t){var s=t[n];s.Fill=e.colorFromARGB(s.Fill),s.Line=e.colorFromARGB(s.Line),a.push(s)}return a})}},{key:"GetGeofencesInRect",value:function(t,e,a,n){var s=this;return this.post("GetGeoFencesInRect",{session:this.token,schemaID:this.schemaID,latmin:t,lngmin:e,latmax:a,lngmax:n},function(t){var e=[];for(var a in t){var n=t[a];n.Fill=s.colorFromARGB(n.Fill),n.Line=s.colorFromARGB(n.Line),e.push(n)}return e})}},{key:"GetOnlineInfo",value:function(t){var e=this;return this.post(null==t?"GetOnlineInfoAll":"GetOnlineInfo",{session:this.token,schemaID:this.schemaID,IDs:null==t?"":t.join(",")},function(t){return e.convert(t)})}},{key:"GetProperties",value:function(t){var e=this;return this.post("GetProperties",{session:this.token,schemaID:this.schemaID,IDs:t.join(",")},function(t){return e.convert(t)})}},{key:"GetGFProperties",value:function(t){var e=this;return this.post("GetGFProperties",{session:this.token,schemaID:this.schemaID,IDs:t.join(",")},function(t){return e.convert(t)})}},{key:"GetDriverProperties",value:function(t){var e=this;return this.post("GetDriverProperties",{session:this.token,schemaID:this.schemaID,IDs:t.join(",")},function(t){return e.convert(t)})}},{key:"GetTrips",value:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this.post("GetTrips",{session:this.token,schemaID:this.schemaID,IDs:t.join(","),SD:v()(e).format(this.FMT_DT),ED:v()(a).format(this.FMT_DT),tripSplitterIndex:n,tripParams:s.length?s.join(","):"",tripTotalParams:s.length?s.join(","):""},function(t){var e=[];for(var a in t)t[a]&&e.push(t[a]);return e})}},{key:"GetStage",value:function(t,e,a,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this.post("GetStage",{session:this.token,schemaID:this.schemaID,IDs:t.join(","),SD:v()(e).format(this.FMT_DT),ED:v()(a).format(this.FMT_DT),stageName:n,tripParams:s.length?s.join(","):"",tripTotalParams:s.length?s.join(","):""},function(t){var e=[];for(var a in t)t[a]&&(t[a].ID=a,e.push(t[a]));return e})}},{key:"GetTrack",value:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return this.post("GetTrack",{session:this.token,schemaID:this.schemaID,IDs:t.join(","),SD:v()(e).format(this.FMT_DT),ED:v()(a).format(this.FMT_DT),tripSplitterIndex:n},function(t){var e=[];for(var a in t)t[a]&&e.push({ID:a,Item:t[a]});return e})}},{key:"GetTripTables",value:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.post("GetTripTables",{session:this.token,schemaID:this.schemaID,IDs:t.join(","),SD:v()(e).format(this.FMT_DT),ED:v()(a).format(this.FMT_DT),tripSplitterIndex:n,onlineParams:s.length?s.join(","):""},function(t){var e=[];for(var a in t)t[a]&&e.push(t[a]);return e})}},{key:"DataEnum",value:function(t){return this.post("DataEnum",{session:this.token,schemaID:this.schemaID,serviceName:this.serviceName,name:t},function(t){if(t.ok){var e={};for(var a in t.data)e[a]=new Date(parseInt(t.data[a].match(/\d+/)[0]));return e}return null})}},{key:"DataLoad",value:function(t){return this.post("DataLoad",{session:this.token,schemaID:this.schemaID,serviceName:this.serviceName,name:t},function(t){return t.ok?t.data:null})}},{key:"DataSave",value:function(t,e){return this.post("DataSave",{session:this.token,schemaID:this.schemaID,serviceName:this.serviceName,name:t,data:e},function(t){return t.ok})}},{key:"CacheFind",value:function(t,e,a,n,s){return this.post("CacheFind",{session:this.token,schemaID:this.schemaID,IDs:null!=t&&t.length>0?t.join(","):"all",SD:v()(e).format(this.FMT_DT),ED:v()(a).format(this.FMT_DT),stageName:n,values:s.join(",")},function(t){var e=[];for(var a in t)t[a]&&e.push(t[a]);return e})}},{key:"SendCommand",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.post("SendCommand",{session:this.token,schemaID:this.schemaID,IDs:t.join(","),commandName:e,arguments:a.join(",")})}},{key:"GetCommandLog",value:function(t,e){return this.post("GetCommandResponse",{session:this.token,schemaID:this.schemaID,SD:v()(t).format(this.FMT_DT),ED:v()(e).format(this.FMT_DT)})}}]),t}();(function(t){t[t["Boolean"]=0]="Boolean",t[t["Byte"]=1]="Byte",t[t["Int32"]=2]="Int32",t[t["Int64"]=3]="Int64",t[t["Double"]=4]="Double",t[t["DateTime"]=5]="DateTime",t[t["TimeSpan"]=6]="TimeSpan",t[t["Guid"]=7]="Guid",t[t["Guid4"]=8]="Guid4",t[t["String"]=9]="String",t[t["Image"]=10]="Image",t[t["Coordinates"]=11]="Coordinates"})(rt||(rt={})),function(t){t[t["GET"]=0]="GET",t[t["GCHANGE"]=1]="GCHANGE",t[t["GVERSION"]=2]="GVERSION",t[t["GIMEI"]=3]="GIMEI",t[t["GACCELERATE"]=4]="GACCELERATE",t[t["GGSMSTAGE"]=5]="GGSMSTAGE",t[t["GICCD"]=6]="GICCD",t[t["DATASEND"]=7]="DATASEND",t[t["GWIFISTAGE"]=8]="GWIFISTAGE",t[t["GALIAS"]=9]="GALIAS",t[t["ALIAS"]=10]="ALIAS",t[t["GTELNUM"]=11]="GTELNUM",t[t["TELNUM"]=12]="TELNUM",t[t["GAPNFULL"]=13]="GAPNFULL",t[t["APNFULL"]=14]="APNFULL",t[t["GPIN"]=15]="GPIN",t[t["PIN"]=16]="PIN",t[t["GPERIODSEND"]=17]="GPERIODSEND",t[t["PERIODSEND"]=18]="PERIODSEND",t[t["GAPNROAMING"]=19]="GAPNROAMING",t[t["APNROAMING"]=20]="APNROAMING",t[t["GROAMINGMODE"]=21]="GROAMINGMODE",t[t["ROAMINGMODE"]=22]="ROAMINGMODE",t[t["GPERIODROAMING"]=23]="GPERIODROAMING",t[t["PERIODROAMING"]=24]="PERIODROAMING",t[t["GSIM2TELNUM"]=25]="GSIM2TELNUM",t[t["SIM2TELNUM"]=26]="SIM2TELNUM",t[t["GSIM2PIN"]=27]="GSIM2PIN",t[t["SIM2PIN"]=28]="SIM2PIN",t[t["GSIM2PERIODSEND"]=29]="GSIM2PERIODSEND",t[t["SIM2PERIODSEND"]=30]="SIM2PERIODSEND",t[t["GSIM2APNFULL"]=31]="GSIM2APNFULL",t[t["SIM2APNFULL"]=32]="SIM2APNFULL",t[t["GSIM2APNROAMING"]=33]="GSIM2APNROAMING",t[t["SIM2APNROAMING"]=34]="SIM2APNROAMING",t[t["GSIM2ROAMINGMODE"]=35]="GSIM2ROAMINGMODE",t[t["SIM2ROAMINGMODE"]=36]="SIM2ROAMINGMODE",t[t["GSIM2PERIODROAMING"]=37]="GSIM2PERIODROAMING",t[t["SIM2PERIODROAMING"]=38]="SIM2PERIODROAMING",t[t["MESSAGE"]=39]="MESSAGE",t[t["GPERIODWR"]=40]="GPERIODWR",t[t["PERIODWR"]=41]="PERIODWR",t[t["GMODEWR"]=42]="GMODEWR",t[t["MODEWR"]=43]="MODEWR",t[t["GADAPTIVESENS"]=44]="GADAPTIVESENS",t[t["ADAPTIVESENS"]=45]="ADAPTIVESENS",t[t["GMODE1"]=46]="GMODE1",t[t["MODE1"]=47]="MODE1",t[t["GMODEWIDE"]=48]="GMODEWIDE",t[t["MODEWIDE"]=49]="MODEWIDE",t[t["GMODETN"]=50]="GMODETN",t[t["MODETN"]=51]="MODETN",t[t["GFULLONLINE"]=52]="GFULLONLINE",t[t["FULLONLINE"]=53]="FULLONLINE",t[t["GDISTANCE"]=54]="GDISTANCE",t[t["DISTANCE"]=55]="DISTANCE",t[t["GP285"]=56]="GP285",t[t["P285"]=57]="P285",t[t["GCOMPACT"]=58]="GCOMPACT",t[t["COMPACT"]=59]="COMPACT"}(ot||(ot={})),function(t){t[t["InProgress"]=0]="InProgress",t[t["OK"]=1]="OK",t[t["Failed"]=2]="Failed",t[t["Timeout"]=3]="Timeout"}(it||(it={})),a.d(e,"$bus",function(){return pt}),a.d(e,"ExternalSettings",function(){return vt}),a.d(e,"connector",function(){return It});var pt=new n["a"]({}),vt=window["external-settings"],It=new ft(vt.Urls.Service,vt.Token,"TAXI",vt.Organization.UID,function(t){return pt.$emit("busy",t)});n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(mt)}}).$mount("#app")},dfd0:function(t,e,a){"use strict";var n=a("04ac"),s=a.n(n);s.a},f44f:function(t,e,a){}});
//# sourceMappingURL=app.9c6c9262.js.map